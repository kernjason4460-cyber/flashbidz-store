<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FlashBidz Store â€” Local Deals â€¢ Mattawan, MI</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <meta name="description" content="FlashBidz â€” fixed-price local deals with easy pickup in Mattawan, MI." />
  <!-- OPTIONAL: Google Analytics 4
       When youâ€™re ready, replace G-XXXXXXX with your Measurement ID
       and remove the surrounding HTML comments. -->
  <!--
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-XXXXXXX');
  </script>
  -->
</head>
<body>
  <!-- ================= HEADER ================= -->
  <header class="site-header" id="top">
    <a class="brand" href="#top">
      <img src="img/flashbidz_logo.svg" alt="FlashBidz" class="logoimg" />
      <div class="name">
        <h1>FlashBidz Store</h1>
        <p class="tagline">Neighbors Helping Neighbors â€¢ Mattawan, MI</p>
      </div>
    </a>
    <nav class="top-cta">
      <a class="btn btn-primary" href="#shop">Shop</a>
      <a class="btn" href="#pickup">Pickup Info</a>
      <a class="btn" href="https://www.facebook.com/flashbidz.mattawan" target="_blank" rel="noopener">
        Message on Facebook
      </a>
    </nav>
  </header>

  <!-- ================= CART BAR ================= -->
  <section class="cart-bar">
    <button id="cart-toggle" class="cart-toggle" type="button">
      Cart (<span id="cart-count">0</span>) â€¢ <span id="cart-total">$0.00</span>
    </button>
  </section>

  <!-- ================= CART PANEL ================= -->
  <aside id="cart-panel" class="cart-panel">
    <div class="cart-panel-inner">
      <h3>Your Cart</h3>

      <!-- Empty state -->
      <p id="cart-empty" class="cart-empty">
        Your cart is empty. Add items from the store to get started.
      </p>

      <ul id="cart-items" class="cart-items">
        <!-- Cart items injected by JS -->
      </ul>

      <div class="cart-summary">
        <div>
          <span>Subtotal</span>
          <strong id="cart-subtotal">$0.00</strong>
        </div>
        <div>
          <span>MI Tax (6%)</span>
          <strong id="cart-tax">$0.00</strong>
        </div>
        <div class="cart-grand">
          <span>Total</span>
          <strong id="cart-grandtotal">$0.00</strong>
        </div>
      </div>

      <button id="checkout-btn" class="btn btn-primary cart-checkout-btn" type="button">
        Pay securely with card
      </button>

      <button id="clear-cart-btn" class="btn cart-clear-btn" type="button">
        Clear Cart
      </button>

      <p class="cart-note">
        Youâ€™ll be taken to Stripeâ€™s secure checkout. Weâ€™ll message you with pickup info after payment.
      </p>
    </div>
  </aside>

  <!-- Checkout status bar -->
  <div id="checkout-message" class="checkout-message hidden"></div>

  <!-- ================= HERO ================= -->
  <section class="hero">
    <h2>Local Deals â€¢ Easy Pickup â€¢ No Bidding</h2>
    <p>Prices shown are <strong>before tax</strong>. Michigan sales tax is added at checkout.</p>
    <div class="hero-cta">
      <input
        id="q"
        class="search"
        type="search"
        placeholder="Search itemsâ€¦ (e.g., bassinet, tools, Barbie)"
        aria-label="Search products"
      />
      <a class="btn btn-primary hero-browse" href="#shop" onclick="document.getElementById('q').focus()">
        Browse All
      </a>
    </div>
  </section>

  <!-- ================= PRODUCT GRID ================= -->
  <main id="shop" class="container">
    <div class="toolbar">
      <div class="toolbar-left">
        <label class="toolbar-label">
          Category:
          <select id="cat" class="select">
            <option value="">All categories</option>
          </select>
        </label>
      </div>
      <div class="toolbar-right">
        <label class="toolbar-label">
          Sort:
          <select id="sort" class="select">
            <option value="new">Newest</option>
            <option value="price-asc">Price: Low to High</option>
            <option value="price-desc">Price: High to Low</option>
          </select>
        </label>
        <span id="count" class="count"></span>
      </div>
    </div>

    <div id="product-grid" class="grid" aria-live="polite"></div>
  </main>

  <!-- ================= PICKUP / POLICIES ================= -->
  <section id="pickup" class="pickup container">
    <h3>Pickup, Payment & Policies</h3>
    <ul>
      <li><strong>Pickup:</strong> Mattawan, MI (exact address provided after purchase). Please pick up within <strong>7 days</strong>.</li>
      <li><strong>Storage:</strong> After 7 days, <strong>$2 per item per day</strong>. After 14 days, items are <strong>abandoned</strong>.</li>
      <li><strong>Payment:</strong> Pay online by <strong>card via secure checkout</strong>. Michigan <strong>6% sales tax</strong> is added at checkout.</li>
      <li><strong>Condition:</strong> Items sold <em>AS-IS, WHERE-IS</em>. <strong>All sales final.</strong></li>
      <li><strong>Questions?</strong> Message us on Facebook or email <a href="mailto:support@flashbidz.net">support@flashbidz.net</a>.</li>
    </ul>
  </section>

  <!-- ================= FOOTER ================= -->
  <footer class="site-footer">
    <p>Â© <span id="year"></span> FlashBidz of Mattawan â€¢ All sales final â€¢ AS-IS, WHERE-IS</p>
  </footer>

  <!-- ================= PRODUCT CARD TEMPLATE ================= -->
  <template id="product-card-tpl">
    <article class="card">
      <div class="img-wrap">
        <img src="" alt="" loading="lazy" />
        <span class="badge"></span>
      </div>
      <div class="card-body">
        <h4 class="title"></h4>
        <p class="desc"></p>

        <div class="meta">
          <span class="price"></span>
          <span class="stock"></span>
        </div>

        <div class="totals">
          <div>Subtotal: <strong class="subtotal"></strong></div>
          <div>MI Sales Tax (<span class="tax-rate"></span>%): <strong class="tax"></strong></div>
          <div>Total: <strong class="total"></strong></div>
        </div>

        <div class="actions">
          <button class="btn btn-primary add-to-cart" type="button">
            Add to Cart
          </button>
        </div>
      </div>
    </article>
  </template>

  <!-- ================= IMAGE GALLERY MODAL ================= -->
  <div id="image-modal" class="image-modal hidden">
    <div class="image-modal-backdrop" onclick="closeImageModal()"></div>
    <div class="image-modal-content">
      <button class="image-modal-close" type="button" onclick="closeImageModal()">Ã—</button>
      <img id="image-modal-main" src="" alt="Product image" />
      <div id="image-modal-thumbs" class="image-modal-thumbs"></div>
    </div>
  </div>

  <!-- Stripe.js -->
  <script src="https://js.stripe.com/v3/"></script>

  <script>
    // =========================
    //  SETTINGS
    // =========================
    const STRIPE_PUBLISHABLE_KEY =
      "pk_live_51Sa4lgCY2ro7M4zrxnzepY4UR27lu8NuSG1Ig2d29Zg2Mb3bHV58nVMPacWHGbhyOV5qBirT8JTneZODr7UvkuDJ00nwHIISsM";
    const STRIPE_PRICE_ID = "price_REPLACE_ME"; // <-- replace with your real 10Â¢-unit price ID
    const MI_TAX_RATE = 0.06; // 6%

    const stripe = Stripe(STRIPE_PUBLISHABLE_KEY);
    let PRODUCTS = [];
    const CART = {};
    // Safe analytics helper (no errors if GA isn't installed)
    function track(eventName, params) {
      if (window.gtag) {
        window.gtag('event', eventName, params || {});
      }
    }
    // =========================
    //  HELPERS
    // =========================
    function money(n) {
      return "$" + (Number(n) || 0).toFixed(2);
    }

    function getImages(p) {
      if (p.images && Array.isArray(p.images) && p.images.length) {
        return p.images;
      }
      if (p.image) {
        return [p.image];
      }
      return ["img/placeholder.png"];
    }

    function getMainImage(p) {
      const imgs = getImages(p);
      return imgs[0];
    }

    // Remaining stock = total stock - what's in cart
    function getRemainingStock(p) {
      if (!p || !p.sku) return Number(p.stock || 0);
      const inCart = CART[p.sku]?.qty || 0;
      const total = Number(p.stock || 0);
      return Math.max(total - inCart, 0);
    }

    function cartTotals() {
      const items = Object.values(CART);
      let sub = 0;
      items.forEach((i) => {
        sub += (Number(i.product.price) || 0) * i.qty;
      });
      const tax = +(sub * MI_TAX_RATE).toFixed(2);
      const total = +(sub + tax).toFixed(2);
      return { sub, tax, total, items };
    }

   // Simple cart feedback: sound + vibrate + cart bump
function cartFeedback() {
  // Vibrate (mobile)
  if (navigator.vibrate) {
    navigator.vibrate(30);
  }

  // Tiny "beep" using Web Audio API (no file needed)
  try {
    // Reuse one AudioContext if possible
    if (!window._flashbidzAudioCtx) {
      window._flashbidzAudioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }
    const ctx = window._flashbidzAudioCtx;

    const osc = ctx.createOscillator();
    const gain = ctx.createGain();

    osc.type = "triangle";          // softer than square/sawtooth
    osc.frequency.value = 880;      // pitch of the beep

    const now = ctx.currentTime;
    gain.gain.setValueAtTime(0.15, now);
    gain.gain.exponentialRampToValueAtTime(0.001, now + 0.16);

    osc.connect(gain);
    gain.connect(ctx.destination);

    osc.start(now);
    osc.stop(now + 0.16);
  } catch (e) {
    // If audio fails (older browser / permissions), just skip sound
    console.warn("Cart sound failed:", e);
  }

  // Cart bump animation
  if (cartToggle) {
    cartToggle.classList.add("cart-bump");
    clearTimeout(window._cartBumpTimer);
    window._cartBumpTimer = setTimeout(() => {
      cartToggle.classList.remove("cart-bump");
    }, 220);
  }
}

    // =========================
    //  DOM ELEMENTS
    // =========================
    const grid = document.getElementById("product-grid");
    const tpl = document.getElementById("product-card-tpl");
    const qInput = document.getElementById("q");
    const catSelect = document.getElementById("cat");
    const sortSelect = document.getElementById("sort");
    const countEl = document.getElementById("count");

    const cartCountEl = document.getElementById("cart-count");
    const cartTotalEl = document.getElementById("cart-total");
    const cartListEl = document.getElementById("cart-items");
    const cartPanel = document.getElementById("cart-panel");
    const cartToggle = document.getElementById("cart-toggle");
    const cartSubEl = document.getElementById("cart-subtotal");
    const cartTaxEl = document.getElementById("cart-tax");
    const cartGrandEl = document.getElementById("cart-grandtotal");
    const checkoutBtn = document.getElementById("checkout-btn");
    const checkoutMsgBar = document.getElementById("checkout-message");
    const clearCartBtn = document.getElementById("clear-cart-btn");
    const cartEmptyEl = document.getElementById("cart-empty");

    // Image modal elements
    const imageModal = document.getElementById("image-modal");
    const imageModalMain = document.getElementById("image-modal-main");
    const imageModalThumbs = document.getElementById("image-modal-thumbs");
    let currentModalImages = [];

    // =========================
    //  IMAGE MODAL
    // =========================
    function openImageModal(product) {
      currentModalImages = getImages(product);
      if (!imageModal || !imageModalMain || !imageModalThumbs) return;

      imageModalMain.src = currentModalImages[0];
      imageModalThumbs.innerHTML = "";

      currentModalImages.forEach((src, idx) => {
        const t = document.createElement("img");
        t.src = src;
        t.alt = (product.title || "Image") + " " + (idx + 1);
        if (idx === 0) t.classList.add("active-thumb");
        t.addEventListener("click", () => {
          imageModalMain.src = src;
          Array.from(imageModalThumbs.querySelectorAll("img")).forEach((el) =>
            el.classList.remove("active-thumb")
          );
          t.classList.add("active-thumb");
        });
        imageModalThumbs.appendChild(t);
      });

      imageModal.classList.remove("hidden");
    }

    function closeImageModal() {
      if (imageModal) imageModal.classList.add("hidden");
    }
    window.closeImageModal = closeImageModal;

    // =========================
    //  LOAD PRODUCTS
    // =========================
    async function loadProducts() {
      try {
        const res = await fetch("products.json?" + Date.now());
        if (!res.ok) throw new Error("products.json not found");
        const data = await res.json();
        PRODUCTS = data.products || [];
      } catch (err) {
        console.error("Error loading products:", err);
        if (grid) {
          grid.innerHTML = "<p style='color:#ccc'>Could not load products.json</p>";
        }
        return;
      }

      // Build category dropdown
      if (catSelect) {
        const cats = Array.from(new Set(PRODUCTS.flatMap((p) => p.categories || []))).sort();
        cats.forEach((c) => {
          if (!c) return;
          const opt = document.createElement("option");
          opt.value = c;
          opt.textContent = c;
          catSelect.appendChild(opt);
        });
      }

      renderGrid();
    }

    // =========================
    //  RENDER GRID
    // =========================
    function renderGrid() {
      if (!grid || !tpl) return;
      const query = ((qInput && qInput.value) || "").toLowerCase().trim();
      const selectedCat = catSelect ? catSelect.value : "";
      const sort = sortSelect ? sortSelect.value : "new";

      let items = PRODUCTS.filter((p) => p.active !== false);

      // Remove items that are completely sold out (0 remaining)
      items = items.filter((p) => getRemainingStock(p) > 0);

      if (selectedCat) {
        items = items.filter((p) => (p.categories || []).includes(selectedCat));
      }
      if (query) {
        items = items.filter((p) =>
          (p.title + " " + (p.description || "")).toLowerCase().includes(query)
        );
      }

      if (sort === "price-asc") {
        items.sort((a, b) => (a.price || 0) - (b.price || 0));
      } else if (sort === "price-desc") {
        items.sort((a, b) => (b.price || 0) - (a.price || 0));
      } else {
        items.sort((a, b) => new Date(b.added_at || 0) - new Date(a.added_at || 0));
      }

      grid.innerHTML = "";
      items.forEach((p) => {
        const node = tpl.content.cloneNode(true);

        const img = node.querySelector("img");
        const titleEl = node.querySelector(".title");
        const descEl = node.querySelector(".desc");
        const priceEl = node.querySelector(".price");
        const stockEl = node.querySelector(".stock");
        const badgeEl = node.querySelector(".badge");
        const subEl = node.querySelector(".subtotal");
        const taxEl = node.querySelector(".tax");
        const totalEl = node.querySelector(".total");
        const taxRateEl = node.querySelector(".tax-rate");
        const actions = node.querySelector(".actions");

        const remaining = getRemainingStock(p);

        // ----- Add to Cart button respecting stock -----
        if (actions) {
          actions.innerHTML = "";
          const addBtn = document.createElement("button");
          addBtn.type = "button";
          addBtn.className = "btn btn-primary btn-cart";

          if (remaining > 0) {
            addBtn.textContent = "Add to Cart";
            addBtn.addEventListener("click", (e) => {
              if (e.stopPropagation) e.stopPropagation();
              addToCart(p);
            });
          } else {
            addBtn.textContent = "Sold Out";
            addBtn.disabled = true;
            addBtn.classList.add("disabled");
          }

          actions.appendChild(addBtn);
        }

        // Image + modal on click
        if (img) {
          const mainImg = getMainImage(p);
          img.src = mainImg;
          img.alt = p.title || "Item";
          img.addEventListener("click", (e) => {
            e.stopPropagation?.();
            openImageModal(p);
          });
        }

        if (titleEl) titleEl.textContent = p.title;
        if (descEl) descEl.textContent = p.description || "";
        if (priceEl) priceEl.textContent = p.price ? money(p.price) : "";

        if (stockEl) {
          if (!p.stock || p.stock <= 0) {
            stockEl.textContent = "Sold Out";
          } else if (remaining === 1) {
            stockEl.textContent = "Only 1 left";
          } else {
            stockEl.textContent = remaining + " available";
          }
        }

        if (badgeEl) {
          if (p.badge) badgeEl.textContent = p.badge;
          else badgeEl.remove();
        }

        const subtotal = Number(p.price || 0);
        const tax = +(subtotal * MI_TAX_RATE).toFixed(2);
        const total = +(subtotal + tax).toFixed(2);

        if (taxRateEl) taxRateEl.textContent = (MI_TAX_RATE * 100).toFixed(0);
        if (subEl) subEl.textContent = money(subtotal);
        if (taxEl) taxEl.textContent = money(tax);
        if (totalEl) totalEl.textContent = money(total);

        grid.appendChild(node);
      });

      if (countEl) {
        countEl.textContent = items.length + " item" + (items.length === 1 ? "" : "s");
      }
    }
      // Analytics: list of items shown
      track('view_item_list', {
        item_list_id: 'main_grid',
        item_list_name: 'FlashBidz Store Grid',
        items: items.map(p => ({
          item_id: p.sku || '',
          item_name: p.title || '',
          price: p.price || 0
        }))
      });
    if (qInput) qInput.addEventListener("input", renderGrid);
    if (catSelect) catSelect.addEventListener("change", renderGrid);
    if (sortSelect) sortSelect.addEventListener("change", renderGrid);

    // =========================
    //  CART FUNCTIONS
    // =========================
    function addToCart(product) {
      if (!product || !product.sku) return;

      const totalStock = Number(product.stock || 0);
      const existing = CART[product.sku]?.qty || 0;

      if (totalStock && existing >= totalStock) {
        alert("You already have the maximum quantity for this item in your cart.");
        return;
      }

      if (!CART[product.sku]) {
        CART[product.sku] = { product, qty: 0 };
      }
      CART[product.sku].qty += 1;

      updateCartUI();
      renderGrid();
      cartFeedback();
    }
      // Analytics: add_to_cart
      track('add_to_cart', {
        currency: 'USD',
        value: Number(product.price || 0),
        items: [{
          item_id: product.sku || '',
          item_name: product.title || '',
          price: product.price || 0,
          quantity: 1
        }]
      });
    
    function changeQty(sku, delta) {
      const entry = CART[sku];
      if (!entry) return;
      entry.qty += delta;
      if (entry.qty <= 0) delete CART[sku];

      updateCartUI();
      renderGrid();
    }

    function clearCart() {
      Object.keys(CART).forEach((k) => delete CART[k]);
      updateCartUI();
      renderGrid();
    }

    function updateCartUI() {
      const { sub, tax, total, items } = cartTotals();

      const itemCount = items.reduce((s, i) => s + i.qty, 0);
      if (cartCountEl) cartCountEl.textContent = itemCount;
      if (cartTotalEl) cartTotalEl.textContent = money(total);

      const isEmpty = itemCount === 0;

      if (cartEmptyEl) {
        cartEmptyEl.style.display = isEmpty ? "block" : "none";
      }
      if (cartListEl) {
        cartListEl.style.display = isEmpty ? "none" : "flex";
      }
      if (checkoutBtn) {
        checkoutBtn.disabled = isEmpty;
        checkoutBtn.classList.toggle("disabled", isEmpty);
      }
      if (clearCartBtn) {
        clearCartBtn.disabled = isEmpty;
        clearCartBtn.classList.toggle("disabled", isEmpty);
      }

      if (cartListEl) {
        cartListEl.innerHTML = "";
        items.forEach(({ product, qty }) => {
          const li = document.createElement("li");
          li.className = "cart-item";

          const name = document.createElement("div");
          name.className = "cart-item-name";
          name.textContent = product.title || product.sku;

          const controls = document.createElement("div");
          controls.className = "cart-item-controls";

          const minus = document.createElement("button");
          minus.type = "button";
          minus.textContent = "âˆ’";
          minus.addEventListener("click", () => changeQty(product.sku, -1));

          const qtySpan = document.createElement("span");
          qtySpan.textContent = qty;

          const plus = document.createElement("button");
          plus.type = "button";
          plus.textContent = "+";
          plus.addEventListener("click", () => changeQty(product.sku, 1));

          controls.append(minus, qtySpan, plus);

          const lineTotal = document.createElement("div");
          lineTotal.className = "cart-item-total";
          lineTotal.textContent = money((product.price || 0) * qty);

          li.append(name, controls, lineTotal);
          cartListEl.appendChild(li);
        });
      }

      if (cartSubEl) cartSubEl.textContent = money(sub);
      if (cartTaxEl) cartTaxEl.textContent = money(tax);
      if (cartGrandEl) cartGrandEl.textContent = money(total);
    }

    // Cart toggle
    if (cartToggle && cartPanel) {
      cartToggle.addEventListener("click", () => {
        cartPanel.classList.toggle("open");
        if (cartPanel.classList.contains("open")) {
          const inner = cartPanel.querySelector(".cart-panel-inner");
          if (inner) inner.scrollTop = 0;
        }
      });
    }
    // Close cart + scroll back to products when "Shop" is clicked
    document.querySelectorAll('a[href="#shop"]').forEach(link => {
      link.addEventListener("click", (e) => {
        e.preventDefault();

        // Close the cart panel if it's open
       if (cartPanel) {
          cartPanel.classList.remove("open");
        }

        const target = document.getElementById("shop");
        if (!target) return;

        const top = target.getBoundingClientRect().top + window.scrollY - 120;
        window.scrollTo({ top, behavior: "smooth" });
      });
    });
    // Clear cart button
    if (clearCartBtn) {
      clearCartBtn.addEventListener("click", () => {
        if (confirm("Clear all items from your cart?")) {
          clearCart();
        }
      });
    }

    // =========================
    //  STRIPE CHECKOUT
    // =========================
    async function checkoutWithStripe() {
      const { total, items } = cartTotals();
      if (!items.length) {
        alert("Your cart is empty.");
        return;
      }

      if (total < 0.5) {
        alert("Order total must be at least $0.50 to pay by card.");
        return;
      }

      // Using a â€œ10Â¢ unitâ€ price in Stripe: quantity = total / 0.10
      const UNIT = 0.10;
      const quantity = Math.round(total / UNIT);

      const description = items
        .map((i) => `${i.qty}x ${i.product.sku || i.product.title}`)
        .join(", ")
        .slice(0, 500);
      // Analytics: begin_checkout
      track('begin_checkout', {
        currency: 'USD',
        value: total,
        items: items.map(i => ({
          item_id: i.product.sku || '',
          item_name: i.product.title || '',
          price: i.product.price || 0,
          quantity: i.qty
        }))
      });
      try {
        const { error } = await stripe.redirectToCheckout({
          lineItems: [{ price: STRIPE_PRICE_ID, quantity }],
          mode: "payment",
          successUrl:
            window.location.origin + window.location.pathname + "?checkout=success",
          cancelUrl:
            window.location.origin + window.location.pathname + "?checkout=cancel",
          clientReferenceId: description
        });

        if (error) {
          console.error(error);
          alert(error.message || "There was a problem starting checkout.");
        }
      } catch (err) {
        console.error(err);
        alert("Something went wrong starting Stripe Checkout.");
      }
    }

    if (checkoutBtn) {
      checkoutBtn.addEventListener("click", checkoutWithStripe);
    }

    // =========================
    //  CHECKOUT STATUS BANNER
    // =========================
    function handleCheckoutStatus() {
      if (!checkoutMsgBar) return;
      const params = new URLSearchParams(window.location.search);
      const status = params.get("checkout");
      if (!status) return;

      if (status === "success") {
        checkoutMsgBar.textContent =
          "Thank you! Your payment was received. Weâ€™ll message you with pickup details.";
        checkoutMsgBar.classList.add("ok");
      } else if (status === "cancel") {
        checkoutMsgBar.textContent =
          "Checkout was canceled â€“ your cart is still here if you want to try again.";
        checkoutMsgBar.classList.add("warn");
      } else {
        return;
      }
      checkoutMsgBar.classList.remove("hidden");
    }
document.querySelectorAll('a[href="#shop"]').forEach(a => {
  a.addEventListener("click", e => {
    e.preventDefault();

    // ðŸ‘‡ CLOSE the cart / checkout panel if it's open
    if (cartPanel) {
      cartPanel.classList.remove("open");
    }

    const el = document.getElementById("shop");
    if (!el) return;

    // Smooth scroll to the products area, with a little offset
    const top = el.getBoundingClientRect().top + window.scrollY - 120;
    window.scrollTo({ top, behavior: "smooth" });
  });
});
    // =========================
    //  INIT
    // =========================
    const yearEl = document.getElementById("year");
    if (yearEl) yearEl.textContent = new Date().getFullYear();

    loadProducts();
    handleCheckoutStatus();
  </script>
</body>
</html>
